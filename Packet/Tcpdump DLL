+------------------------------------------------------+
| Field            | Offset | Length | Description     |
|------------------|--------|--------|-----------------|
| Destination MAC  |   0    |   6    | First 6 bytes  |
| Source MAC       |   6    |   6    | Next 6 bytes   |
| EtherType        |  12    |   2    | Protocol type   |
+------------------------------------------------------+
+------------------------------------------------------------------------------------+
| 1. Capture ARP Frames                                                              |
+------------------------------------------------------------------------------------+
| Command:                                                                           |
| tcpdump -i eth0 'ether[12:2] = 0x0806'                                            |
|                                                                                    |
| Explanation:                                                                       |
|  ether        → Inspect Ethernet header                                           |
|  [12:2]       → Start at byte 12, read 2 bytes (EtherType field)                 |
|  = 0x0806     → Matches ARP protocol                                              |
+------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------+
| 2. Capture IPv4 Frames                                                             |
+------------------------------------------------------------------------------------+
| Command: tcpdump -i eth0 'ether[12:2] = 0x0800'                                   |
| Explanation: ether[12:2] → EtherType field | 0x0800 → Matches IPv4               |
+------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------+
| 3. Capture IPv6 Frames                                                             |
+------------------------------------------------------------------------------------+
| Command: tcpdump -i eth0 'ether[12:2] = 0x86dd'                                   |
| Explanation: ether[12:2] → EtherType field | 0x86dd → Matches IPv6               |
+------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------+
| 4. Filter by Destination MAC Address                                               |
+------------------------------------------------------------------------------------+
| Command: tcpdump -i eth0 'ether[0:6] = 0x112233445566'                            |
| Explanation: ether[0:6] → First 6 bytes of Ethernet header (Dest MAC)            |
+------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------+
| 6. Capture Broadcast Frames                                                        |
+------------------------------------------------------------------------------------+
| Command: tcpdump -i eth0 'ether[0:6] = 0xffffffffffff'                            |
| Explanation: ether[0:6] → Destination MAC field | ff:ff:ff:ff:ff:ff → Broadcast  |
+------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------+
| 7. Capture Multicast Frames                                                        |
+------------------------------------------------------------------------------------+
| Command: tcpdump -i eth0 'ether[0] & 1 != 0'                                      |
| Explanation: ether[0] → First byte of Dest MAC | & 1 != 0 → Multicast indicator  |
+------------------------------------------------------------------------------------+
| 8. VLAN, 802.1Q                                                                    |
----------------------------------------------------------------------------------------
| 'ether[12:2] = 0x8100 && ether[14:2] & 0x0fff = 0x0064'                            |
| 'ether[12:4] & 0xffff0fff = 0x81000064'                                             |
|--------------------------------------------------------------------------------------------
| 9. Double VLAN Tagging                                                               |
-----------------------------------------------------------------------------------------
| 'ether[12:2] = 0x8100 && ether[16:2] = 0x8100'                                        |
-------------------------------------------------------------------------------------------
✔ Use -nn to disable name resolution
✔ Use -s 0 for full packet capture
✔ Combine conditions with && (AND) and || (OR)
✔ Write capture: tcpdump -w file.pcap
✔ Read capture: tcpdump -r file.pcap
✔ Show payload: -A or -X
HTTP      → tcpdump -i eth0 'tcp port 80'
HTTPS     → tcpdump -i eth0 'tcp port 443'
DNS       → tcpdump -i eth0 'udp port 53'
SSH       → tcpdump -i eth0 'tcp port 22'
ICMP      → tcpdump -i eth0 'icmp'
SYN only  → tcpdump 'tcp[tcpflags] & tcp-syn != 0 and tcp[tcpflags] & tcp-ack == 0'
